#!/usr/bin/env bash
#
# mgs - (c) wtfpl 2017
#
# manage your daily tasks like a pro
# by appending tasks to a text file
#
# Usage:
#
#   $ todo commit early
#   $ todo commit often
#   $ todo

TODOS=${TODOS:-$HOME/.todo}
EDITOR=${EDITOR:-vim}

#
# List contents of todo file
#

list() {
  test -f $TODOS && nl -s ": " $TODOS
}

#
# Add arguments to the todo file
#

add() {
  echo "$*" >> $TODOS
}

#
# Remove todo from the todo file
#

remove() {
  test -n "$1" || exit 1
  sed -i "" -e "${1}d" $TODOS; list
}

# open file in $EDITOR
test "$1" == '-o' && $EDITOR $TODOS && exit 0

test "$1" == '-r' && remove "$2" && exit 0

# delete todo file if invoked with --clear
test "$1" == '--clear' && rm $TODOS && exit 0

# add to list if any arguments passed
test -n "$*" && add "$*" || list

exit 0
