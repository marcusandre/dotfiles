#!/usr/bin/env sh

#
# Print usage information
#

function usage() {
  echo "Usage: token 32" &&  exit 1
}

#
# Generate new token
#

function generate() {
  local len=$1
  base64 /dev/urandom | fold -w ${len} | head -n 1
}

#
# Check `base64`
#

which -s base64
if [[ $? != 0 ]] ; then
  echo "Error: base64 seems not to be installed." && exit 1
fi

#
# Parse <args>
#

if [[ $# -ne 1 || -n ${1//[0-9]/} ]]; then
  usage && exit 1
else
  generate $1 && exit 0
fi
